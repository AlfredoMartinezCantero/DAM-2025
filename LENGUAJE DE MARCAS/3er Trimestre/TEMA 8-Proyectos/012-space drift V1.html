<!doctype html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Deep Orbit: Drift</title>

<style>
body{
    margin:0;
    overflow:hidden;
    background:radial-gradient(circle at center,#050914,#000);
    font-family:system-ui,Segoe UI;
    color:#e6f1ff;
}

canvas{ display:block; }

#hud{
    position:absolute;
    top:20px;
    left:20px;
    padding:14px 18px;
    background:rgba(10,15,30,.55);
    backdrop-filter:blur(8px);
    border-radius:14px;
    box-shadow:0 0 25px rgba(0,0,0,.8);
    min-width:180px;
}

.stat{
    font-size:.95rem;
    margin-bottom:6px;
}

#center{
    position:absolute;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    pointer-events:none;
    font-size:2.8rem;
    font-weight:900;
    opacity:0;
    transition:.3s;
    text-shadow:0 0 25px #000;
}

#center.show{ opacity:1; }

.hint{
    position:absolute;
    bottom:16px;
    width:100%;
    text-align:center;
    font-size:.85rem;
    opacity:.5;
}
</style>
</head>
<body>

<div id="hud">
    <div class="stat">üîã Energ√≠a: <span id="energy">100</span>%</div>
    <div class="stat">üåÄ Velocidad: <span id="speed">0</span></div>
    <div class="stat">‚≠ê Distancia: <span id="score">0</span></div>
</div>

<div id="center"></div>
<div class="hint">W acelerar ¬∑ A/D rotar ¬∑ S frenar ¬∑ R estabilizar</div>

<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

function resize(){
    canvas.width=innerWidth;
    canvas.height=innerHeight;
}
addEventListener("resize",resize);
resize();

const keys={};

addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

const state={
    energy:100,
    score:0
};

/* ===== PLAYER ===== */
const ship={
    x:0,y:0,
    vx:0,vy:0,
    angle:0,
    update(){
        // rotaci√≥n
        if(keys.a) this.angle-=0.05;
        if(keys.d) this.angle+=0.05;

        // thrust
        if(keys.w && state.energy>0){
            this.vx+=Math.cos(this.angle)*0.12;
            this.vy+=Math.sin(this.angle)*0.12;
            state.energy-=0.08;
        }

        // brake
        if(keys.s){
            this.vx*=0.98;
            this.vy*=0.98;
            state.energy-=0.05;
        }

        // stabilize
        if(keys.r && state.energy>0){
            this.vx*=0.9;
            this.vy*=0.9;
            state.energy-=0.15;
        }

        this.x+=this.vx;
        this.y+=this.vy;
    },
    draw(){
        ctx.save();
        ctx.translate(this.x,this.y);
        ctx.rotate(this.angle);
        ctx.strokeStyle="#7df9ff";
        ctx.lineWidth=2;
        ctx.beginPath();
        ctx.moveTo(12,0);
        ctx.lineTo(-10,7);
        ctx.lineTo(-6,0);
        ctx.lineTo(-10,-7);
        ctx.closePath();
        ctx.stroke();
        ctx.restore();
    }
};

/* ===== PLANETS ===== */
class Planet{
    constructor(){
        this.x=Math.random()*2000-1000;
        this.y=Math.random()*2000-1000;
        this.r=40+Math.random()*60;
        this.mass=this.r*0.04;
    }
    applyGravity(){
        const dx=this.x-ship.x;
        const dy=this.y-ship.y;
        const d=Math.hypot(dx,dy);

        if(d<this.r){
            gameOver("DESTRUIDO POR GRAVEDAD");
        }

        if(d<500){
            const force=this.mass/(d*d);
            ship.vx+=dx*force;
            ship.vy+=dy*force;
        }
    }
    draw(){
        ctx.fillStyle="#334";
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
        ctx.fill();
    }
}

const planets=Array.from({length:6},()=>new Planet());

/* ===== ENERGY ORBS ===== */
class Orb{
    constructor(){
        this.x=Math.random()*2000-1000;
        this.y=Math.random()*2000-1000;
        this.r=8;
    }
    draw(){
        ctx.fillStyle="#ffd966";
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
        ctx.fill();
    }
}

let orbs=Array.from({length:12},()=>new Orb());

/* ===== GAME ===== */
function gameOver(msg){
    center.textContent=msg;
    center.classList.add("show");
    setTimeout(()=>location.reload(),2000);
}

/* ===== LOOP ===== */
function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.save();
    ctx.translate(canvas.width/2,canvas.height/2);
    ctx.translate(-ship.x,-ship.y);

    ship.update();
    ship.draw();

    planets.forEach(p=>{
        p.applyGravity();
        p.draw();
    });

    orbs.forEach((o,i)=>{
        o.draw();
        if(Math.hypot(ship.x-o.x,ship.y-o.y)<15){
            state.energy=Math.min(100,state.energy+20);
            orbs.splice(i,1);
        }
    });

    ctx.restore();

    state.energy-=0.01;
    if(state.energy<=0) gameOver("ENERG√çA AGOTADA");

    state.score+=Math.hypot(ship.vx,ship.vy)*0.05;

    energy.textContent=Math.floor(state.energy);
    speed.textContent=Math.hypot(ship.vx,ship.vy).toFixed(1);
    score.textContent=Math.floor(state.score);

    requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
